<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Universal Gemini Chat</title>
</head>
<body>

<h1>Chat with Gemini (Securely!)</h1>

<form onsubmit="sendMessage(); return false;">
    <input type="text" id="promptInput" placeholder="Ask Gemini anything..." style="width: 80%;">
    <button type="submit">Send</button> 
</form>

<p id="response" style="margin-top: 20px; border: 1px solid #ccc; padding: 10px; white-space: pre-wrap;">Response will appear here...</p>

    <script>
        // *** CORRECT VERCEL SECURE PROXY ENDPOINT ***
        const PROXY_URL = "https://gemini-api-proxy-xi-two.vercel.app/api/gemini"; 
        
        // >>>>>> CRITICAL FIX: Setting the supported model name <<<<<<
        const MODEL_NAME = "gemini-2.5-flash"; 

        async function sendMessage() {
            const prompt = document.getElementById('promptInput').value;
            const responseElement = document.getElementById('response');
            responseElement.textContent = "Waiting for response from secure proxy...";

            if (!prompt) return;

            const requestBody = {
                contents: [
                    { parts: [{ text: prompt }] }
                ],
                model: MODEL_NAME 
            };

            try {
                const response = await fetch(PROXY_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestBody)
                });

                const data = await response.json();

                if (response.ok) {
                    if (data.candidates && data.candidates[0].content && data.candidates[0].content.parts) {
                        const geminiText = data.candidates[0].content.parts[0].text;
                        responseElement.textContent = geminiText;
                    } else {
                        responseElement.textContent = "Error: Could not get a valid response from the AI.";
                    }
                } else {
                    responseElement.textContent = `Error from Proxy Server: ${data.error.message || data.error || response.statusText}`;
                }


            } catch (error) {
                console.error('Fetch error:', error);
                responseElement.textContent = `Network Error: Could not connect to the proxy server.`;
            }
        }
    </script>
</body>
</html>
